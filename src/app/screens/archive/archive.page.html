<ion-header [translucent]="true">
  <ion-toolbar color="light">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/" />
    </ion-buttons>
    <ion-title>
      <div class="flex flex-col items-center justify-center">
        <div class="block leading-6">Learn Sessions</div>
        <!-- <ion-text class="!text-xs text-neutral-600">{{ weekRangeLabel }}</ion-text> -->
      </div>
    </ion-title>
    <ion-buttons slot="end">
      <ion-button mode="ios" fill="clear" (click)="getCurrentWeek()">
        <ion-icon name="today" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>

  <div [ngStyle]="{'background-color': 'var(--ion-color-light)'}" class="pb-2">
    <app-simple-calendar (weekRangeLabel)="getWeekRangeLabel($event)" (weekDataResult)="getWeekDataResult($event)" (dayClicked)="onDayClicked($event)"></app-simple-calendar>
  </div>
</ion-header>

<ion-content color="light">
  <ion-refresher slot="fixed" (ionRefresh)="handleRefresh($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>

  <div class="ion-padding">
    @if (enrolledLessons$ | async; as enrolled) {
      @if (enrolled.isLoading) {
        <div class="h-full flex flex-col items-center justify-center">
          <ion-spinner name="dots" class="w-24"></ion-spinner>
          <div class="block text-center mt-4">
            <span class="text-gray-500">Waiting magic...</span>
          </div>
        </div>
      } @else {
        @for (item of enrolled.data; track item) {
          <div class="mb-5">
            <app-learn-card [item]="item"></app-learn-card>
          </div>
        }

        @if (enrolled.data.length <= 0) {
          <div class="text-center text-gray-500">
            No lessons found for this  {{ selectedDay ? 'day' : 'week' }}.
          </div>
        }
      }
    } 
  </div>

  <ion-infinite-scroll (ionInfinite)="onIonInfinite($event)" [disabled]="!haveMoreData">
    <ion-infinite-scroll-content></ion-infinite-scroll-content>
  </ion-infinite-scroll>
</ion-content>
